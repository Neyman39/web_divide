<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="assets/css/k_card_style copy.css">
    <link rel="stylesheet" href="assets/css/k_card_phone.css">
    <link rel="stylesheet" href="assets/css/navpanel.css">
    <link rel="stylesheet" href="assets/css/navpanel_phone.css">
    <link rel="stylesheet" href="assets/css/footer.css">
    <link rel="stylesheet" href="assets/css/footer_phone.css">
    <link rel="stylesheet" href="assets/css/slider.css">
    <link rel="stylesheet" href="assets/css/slider_phone.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Rubik:ital,wght@0,300..900;1,300..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=IBM+Plex+Mono:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,100;1,200;1,300;1,400;1,500;1,600;1,700&family=IBM+Plex+Sans:ital,wght@0,100..700;1,100..700&family=JetBrains+Mono:ital,wght@0,100..800;1,100..800&family=Press+Start+2P&family=Source+Code+Pro:ital,wght@0,200..900;1,200..900&family=Ubuntu+Mono:ital,wght@0,400;0,700;1,400;1,700&family=Ubuntu+Sans+Mono:ital,wght@0,400..700;1,400..700&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=VT323&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@300..700&family=VT323&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Play:wght@400;700&display=swap" rel="stylesheet">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KeyDivide - Product</title>
</head>
<body>
    
<!-- Header (–æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –±—ã–ª–æ) -->
<header class="header">
    <div class="container">
        <div class="header__inner">
            <div><a class="header__logo" href="–ì–ª–∞–≤–Ω–∞—è.html">KeyDivide</a></div>
            <nav class="nav">
                <ul>
                    <li class="_link"><a class="nav__link" href="–ì–ª–∞–≤–Ω–∞—è.html#keyboards">–ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã</a></li>
                    <li class="_link"><a class="nav__link" href="–ì–ª–∞–≤–Ω–∞—è.html#services">–£—Å–ª—É–≥–∏</a></li>
                    <li class="_link"><a class="nav__link" href="–ì–ª–∞–≤–Ω–∞—è.html#aboutus">–û –Ω–∞—Å</a></li>
                    <li class="_link"><a class="nav__link" href="#">–°–æ—Ü—Å–µ—Ç–∏</a>
                        <ul class="url">
                            <li class="two_link" style="margin-top: 10px;"><a class="url__link" href="https://discord.gg/PKZ8ejUB8Z" target="_blank">Discord</a></li>
                            <li class="two_link"><a class="url__link" href="https://vk.com/cacao_keyboards" target="_blank">–í–∫–æ–Ω—Ç–∞–∫—Ç–µ</a></li>
                            <li class="two_link"><a class="url__link" href="https://www.youtube.com/@cacaoboards7930/featured" target="_blank">YouTube</a></li>
                        </ul>
                    </li>					
                </ul>   
            </nav>
        </div>
        <div style="flex-direction: row; display: flex; align-items: center;">
            <div id="authStatus"></div>
            <a class="ikon" id="account" href="–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è.html" title="–ü—Ä–æ—Ñ–∏–ª—å"><img src="assets/images/–∞–∫–∫–∞—É–Ω—Ç.png" width="26" height="24"></a>
            <a class="ikon" href="–ö–æ—Ä–∑–∏–Ω–∞.html" title="–ö–æ—Ä–∑–∏–Ω–∞"><img src="assets/images/–∫–æ—Ä–∑–∏–Ω–∞.png" width="26" height="26"></a>
        </div>
    </div>
</header>

<!-- Mobile Header (–æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –±—ã–ª–æ) -->
<header class="header_phone">
    <div class="container">
        <div class="header__inner">
            <nav class="nav">
                <ul>
                    <li class="_link"><a class="nav__link" href="#" style="font-size: 30px;">=</a>
                        <ul class="url">
                            <li class="two_link"><a class="nav__link" href="–ì–ª–∞–≤–Ω–∞—è.html#keyboards">–ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã</a></li>
                            <li class="two_link"><a class="nav__link" href="–ì–ª–∞–≤–Ω–∞—è.html#services">–£—Å–ª—É–≥–∏</a></li>
                            <li class="two_link"><a class="nav__link" href="–ì–ª–∞–≤–Ω–∞—è.html#aboutus">–û –Ω–∞—Å</a></li>
                            <li class="two_link" style="margin-top: 10px;"><a class="nav__link" href="https://discord.gg/PKZ8ejUB8Z" target="_blank">Discord</a></li>
                            <li class="two_link"><a class="nav__link" href="https://vk.com/cacao_keyboards" target="_blank">–í–∫–æ–Ω—Ç–∞–∫—Ç–µ</a></li>
                            <li class="two_link"><a class="nav__link" href="https://www.youtube.com/@cacaoboards7930/featured" target="_blank">YouTube</a></li>
                        </ul>
                    </li>					
                </ul>   
            </nav>
            <div><a class="header__logo" href="–ì–ª–∞–≤–Ω–∞—è.html">KeyDivide</a></div>
            <div>
                <a class="ikon" href="–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è.html" title="–ü—Ä–æ—Ñ–∏–ª—å"><img src="assets/images/–∞–∫–∫–∞—É–Ω—Ç.png" width="26" height="24"></a>
                <a class="ikon" href="–ö–æ—Ä–∑–∏–Ω–∞.html" title="–ö–æ—Ä–∑–∏–Ω–∞"><img src="assets/images/–∫–æ—Ä–∑–∏–Ω–∞.png" width="26" height="26"></a>
            </div>
        </div>
    </div>
</header>

<!-- –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–Ω—Ç–µ–Ω—Ç -->
<div class="intro">
    <div class="baza">
        <div class="think_about_title">
            <div class="slider-container">
                <button class="prev-btn" aria-label="–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø—Ä–µ–¥—ã–¥—É—â–∏–π —Å–ª–∞–π–¥">
                    <img src="assets/images/—Å—Ç—Ä–µ–ª–∫–∞.png" alt="–ü—Ä–µ–¥—ã–¥—É—â–µ–µ" width="20" height="20" style="rotate: 180deg;">
                </button>
                <div class="slider">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                    <img src="" alt="Loading..." class="main-image" width="810" height="440" id="mainImage">
                </div>
                <button class="next-btn" aria-label="–ü–æ—Å–º–æ—Ç—Ä–µ—Ç—å —Å–ª–µ–¥—É—é—â–∏–π —Å–ª–∞–π–¥">
                    <img src="assets/images/—Å—Ç—Ä–µ–ª–∫–∞.png" alt="–°–ª–µ–¥—É—é—â–µ–µ" width="20" height="20">
                </button>
            </div> 
            <div class="thumbnail-container-phone">
                <div class="thumbnail-list" id="phoneThumbnails">
                    <!-- –ú–∏–Ω–∏–∞—Ç—é—Ä—ã –¥–ª—è —Ç–µ–ª–µ—Ñ–æ–Ω–∞ -->
                </div>
            </div> 
        </div>
        <div class="prod_info">
            <div class="wrapper">
                <h1 class="typing-demo" id="productName">–ó–∞–≥—Ä—É–∑–∫–∞...</h1>
            </div>
            <div class="box-prod">
                <p class="prod" id="productDescription">–ó–∞–≥—Ä—É–∑–∫–∞ –æ–ø–∏—Å–∞–Ω–∏—è...</p>
            </div>
            <div class="form">
                <h2>–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏</h2>
                <div class="switches" id="switchesContainer">
                    <!-- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ –∑–∞–ø–æ–ª–Ω—è—Ç—Å—è —á–µ—Ä–µ–∑ JS -->
                </div>
            </div>
            <div class="box-price">
                <p class="price" id="productPrice">0 ‚ÇΩ</p>
            </div>
            <div class="butt">
               <div id="addToCartBtn" class="button" style="cursor:pointer;">
                  <p>–í –∫–æ—Ä–∑–∏–Ω—É</p>
                  <img src="assets/images/–∫–æ—Ä–∑–∏–Ω–∞.png" alt="–ö–æ—Ä–∑–∏–Ω–∞" width="26" height="24"> 
               </div>
               <div class="deliver"><p>–ë–µ—Å–ø–ª–∞—Ç–Ω–∞—è –¥–æ—Å—Ç–∞–≤–∫–∞ –æ—Ç 4 –¥–Ω–µ–π üöö</p></div>
            </div>
        </div>
    </div>
    <div class="card">
        <div class="thumbnail-container">
            <div class="thumbnail-list" id="desktopThumbnails">
                <!-- –ú–∏–Ω–∏–∞—Ç—é—Ä—ã –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞ -->
            </div>
        </div>
        <div class="terminal">
            <div class="header_code">
              <span class="icon red"></span>
              <span class="icon yellow"></span>
              <span class="icon green"></span>
              <h2 id="terminalTitle">Product Info.json</h2>
            </div>
            <div class="json_style">
                <div class="numbers">1 2 3 4 5 6 7 8 9 10 11 12</div>
                <pre class="code" id="specificationsCode">
<!-- –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
                </pre>
                <div class="numbers">1 2 3 4 5 6 7 8</div>
                <pre class="code" id="equipmentCode">
<!-- –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è –±—É–¥–µ—Ç –∑–¥–µ—Å—å -->
                </pre>
            </div>
        </div>

        <!-- <div class="specs">
            <div class="bombom">
                <h3 class="spectitle">–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏</h3>
                <div id="specificationsList">
                    –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å
                </div>
            </div>
            <div class="bombom2">
                <h3>–ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è</h3>
                <div id="equipmentList">
                    –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è –±—É–¥–µ—Ç –∑–¥–µ—Å—å
                </div>
            </div>
        </div> -->
    </div>
</div>  

<!-- Footer (–æ—Å—Ç–∞–≤–ª—è–µ–º –∫–∞–∫ –±—ã–ª–æ) -->
<div class="footer">
    <div class="footbox">
        <div class="line"></div>
        <div class="colums">
            <div class="col1">
                <h1>KeyDivide</h1>
                <p>made by people for people</p>
            </div>
            <div class="colinfo">
                <div class="col2">
                    <h1 class="coltitle">–ú–∞–≥–∞–∑–∏–Ω</h1>
                    <p class="coltext"><a href="–ì–ª–∞–≤–Ω–∞—è.html#keyboards">–ö–ª–∞–≤–∏–∞—Ç—É—Ä—ã</a></p>
                    <p class="coltext"><a href="–ì–ª–∞–≤–Ω–∞—è.html#services">–£—Å–ª—É–≥–∏</a></p>
                </div>
                <div class="col3">
                    <h1 class="coltitle">–°–æ—Ü—Å–µ—Ç–∏</h1>
                    <a href="https://discord.gg/PKZ8ejUB8Z" target="_blank"><p class="coltext">Discord</p></a>
                    <a href="https://vk.com/cacao_keyboards" target="_blank"><p class="coltext">–í–∫–æ–Ω—Ç–∞–∫—Ç–µ</p></a>
                    <a href="https://www.youtube.com/@cacaoboards7930/featured" target="_blank"><p class="coltext">YouTube</p></a>  
                </div>
                <div class="col4">
                    <h1 class="coltitle">–ò–Ω—Ñ–æ</h1>
                    <p class="coltext"><a href="–ì–ª–∞–≤–Ω–∞—è.html#aboutus">–û –Ω–∞—Å</a></p>
                </div>
                <div class="col5">
                    <h1 class="coltitle">–ö–æ–Ω—Ç–∞–∫—Ç—ã</h1>
                    <p class="coltext">of_keydivide@mail.ru</p>
                </div>
            </div>
        </div>
    </div>
    <div class="by">
        <div class="byby">
            <p>¬©CacaoBoards All Rights Reserved</p>
            <p>Designed with ‚ù§Ô∏è by neyman</p>
        </div>
    </div>
</div>

<script>
// –ü–æ–ª—É—á–∞–µ–º ID –ø—Ä–æ–¥—É–∫—Ç–∞ –∏–∑ URL
function getProductIdFromUrl() {
    const urlParams = new URLSearchParams(window.location.search);
    return urlParams.get('id') || 2; // –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é ID 1, –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω
}

// –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–¥—É–∫—Ç–∞
async function loadProductData() {
    const productId = getProductIdFromUrl();
    
    try {
        const response = await fetch(`/api/products/${productId}`);
        if (!response.ok) {
            throw new Error('Product not found');
        }
        
        const productData = await response.json();
        renderProductPage(productData);
        setupEventListeners(productData);
        
    } catch (error) {
        console.error('Error loading product:', error);
        document.getElementById('productName').textContent = '–¢–æ–≤–∞—Ä –Ω–µ –Ω–∞–π–¥–µ–Ω';
    }
}

// –†–µ–Ω–¥–µ—Ä–∏–Ω–≥ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ
function renderProductPage(data) {
    // –û—Å–Ω–æ–≤–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
    document.getElementById('productName').textContent = data.name;
    document.getElementById('productDescription').textContent = data.description;
    document.getElementById('productPrice').textContent = `${Math.round(data.current_price)} ‚ÇΩ`;
    document.getElementById('terminalTitle').textContent = `${data.name} Info.json`;

    // –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
    renderImages(data.images);
    
    // –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏
    renderSwitches(data.available_switches);
    
    // –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
    renderSpecificationsCode(data.specifications);
    
    // –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
    renderEquipmentCode(data.equipment);
    
    // // –•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏ –≤ —Å–ø–∏—Å–∫–µ
    // renderSpecificationsList(data.specifications);
    
    // // –ö–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏—è –≤ —Å–ø–∏—Å–∫–µ
    // renderEquipmentList(data.equipment);
}

// –†–µ–Ω–¥–µ—Ä –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
function renderImages(images) {
    if (images.length === 0) return;
    
    const mainImage = document.getElementById('mainImage');
    mainImage.src = images[0].url;
    mainImage.alt = images[0].alt;
    
    // –ú–∏–Ω–∏–∞—Ç—é—Ä—ã –¥–ª—è –¥–µ—Å–∫—Ç–æ–ø–∞
    const desktopThumbnails = document.getElementById('desktopThumbnails');
    const phoneThumbnails = document.getElementById('phoneThumbnails');
    
    desktopThumbnails.innerHTML = '';
    phoneThumbnails.innerHTML = '';
    
    images.forEach((image, index) => {
        const thumbnail = document.createElement('img');
        thumbnail.src = image.url;
        thumbnail.alt = image.alt;
        thumbnail.className = 'thumbnail' + (index === 0 ? ' active' : '');
        thumbnail.onclick = () => changeMainImage(image.url, image.alt, index);
        
        desktopThumbnails.appendChild(thumbnail.cloneNode(true));
        phoneThumbnails.appendChild(thumbnail);
    });
}

// –†–µ–Ω–¥–µ—Ä –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–π
function renderSwitches(switches) {
    const container = document.getElementById('switchesContainer');
    container.innerHTML = '';
    
    switches.forEach(sw => {
        const button = document.createElement('button');
        button.className = 'config-button';
        button.setAttribute('data-config', sw.id);
        button.setAttribute('data-price', sw.total_price);
        
        button.innerHTML = `
            <div class="swbox">${sw.name}
                <div class="switch__overlay">
                    <div class="switch__inner">
                        <div class="switch__info">
                            <div class="switch__image">
                                <img src="assets/images/${getSwitchImage(sw.name)}.png" alt="${sw.name}" width="80" height="80">
                            </div>
                            <div class="switch__title">
                                <p class="switch__name">${sw.name}</p>
                                <div class="switch__type">${sw.type}</div>
                            </div>
                        </div>
                        <div class="swith__specs">
                            <div class="spec__line"><p>–°–∏–ª–∞ —Å—Ä–∞–±–∞—Ç—ã–≤–∞–Ω–∏—è</p><p>${sw.actuation_force}g</p></div>
                            <div class="li_line"></div>
                            <div class="spec__line"><p>–°–∏–ª–∞ –¥–æ —É–ø–æ—Ä–∞</p><p>${sw.bottom_force}g</p></div>
                            <div class="li_line"></div>
                            <div class="spec__line"><p>–°–∏–ª–∞ —Ç–∞–∫—Ç–∏–ª—å–Ω–æ—Å—Ç–∏</p><p>${sw.tactile_force || 'none'}</p></div>
                            <div class="li_line"></div>
                            <div class="spec__line"><p>–î–ª–∏–Ω–∞ –ø—É—Ç–∏</p><p>${sw.travel_length}</p></div>
                            <div class="li_line"></div>
                        </div>
                    </div>
                </div>
            </div>
        `;
        
        if (sw.is_default) {
            button.style.border = '1.5px solid rgb(255, 122, 105)';
        }
        
        container.appendChild(button);
    });
}

// –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–≤–∏—Ç—á–∞
function getSwitchImage(switchName) {
    const images = {
        'Akko V3 Cream Yellow': 'akko-yellow',
        'Akko V3 Cream Blue': 'akko-blue',
        'Outemu Silent Peach': 'outemu-peach'
    };
    return images[switchName] || 'default-switch';
}

// –†–µ–Ω–¥–µ—Ä —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–π –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
function renderSpecificationsCode(specs) {
    const codeElement = document.getElementById('specificationsCode');
    let code = '"specifications": {\n';
    
    specs.forEach(spec => {
        code += `    <span class="key1">"${spec.key}"</span>: <span class="value1">"${spec.value}"</span>,\n`;
    });
    
    code = code.slice(0, -2) + '\n}'; // –£–±–∏—Ä–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é –∑–∞–ø—è—Ç—É—é
    codeElement.innerHTML = code;
}

// –†–µ–Ω–¥–µ—Ä –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏–∏ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
function renderEquipmentCode(equipment) {
    const codeElement = document.getElementById('equipmentCode');
    let code = '"equipment": [\n';
    
    equipment.forEach(item => {
        code += `    <span class="key1">"${item}"</span>,\n`;
    });
    
    code = code.slice(0, -2) + '\n]'; // –£–±–∏—Ä–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω—é—é –∑–∞–ø—è—Ç—É—é
    codeElement.innerHTML = code;
}

// –†–µ–Ω–¥–µ—Ä —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫ –≤ —Å–ø–∏—Å–∫–µ
// function renderSpecificationsList(specs) {
//     const container = document.getElementById('specificationsList');
//     container.innerHTML = '';
    
//     specs.forEach(spec => {
//         const specHTML = `
//             <div class="haracter">
//                 <p class="spectext">${spec.key}</p>
//                 <p class="spectext2">${spec.value}</p>
//             </div>
//             <div class="li_line"></div>
//         `;
//         container.innerHTML += specHTML;
//     });
// }

// –†–µ–Ω–¥–µ—Ä –∫–æ–º–ø–ª–µ–∫—Ç–∞—Ü–∏–∏ –≤ —Å–ø–∏—Å–∫–µ
// function renderEquipmentList(equipment) {
//     const container = document.getElementById('equipmentList');
//     container.innerHTML = '';
    
//     equipment.forEach(item => {
//         const itemHTML = `
//             <div class="complect">
//                 <div class="dot"></div>
//                 <p>${item}</p>
//             </div>
//         `;
//         container.innerHTML += itemHTML;
//     });
// }

// –°–º–µ–Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
function changeMainImage(src, alt, index) {
    const mainImage = document.getElementById('mainImage');
    mainImage.src = src;
    mainImage.alt = alt;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –º–∏–Ω–∏–∞—Ç—é—Ä—ã
    document.querySelectorAll('.thumbnail').forEach((thumb, i) => {
        thumb.classList.toggle('active', i === index);
    });
}

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
function setupEventListeners(data) {
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–Ω–æ–ø–æ–∫ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–π
    document.querySelectorAll('.config-button').forEach(button => {
        button.addEventListener('click', function() {
            const switchId = this.getAttribute('data-config');
            const newPrice = this.getAttribute('data-price');
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ü–µ–Ω—É
            document.getElementById('productPrice').textContent = `${Math.round(newPrice)} ‚ÇΩ`;
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Ä–∞–º–∫–∏ –∫–Ω–æ–ø–æ–∫
            document.querySelectorAll('.config-button').forEach(btn => {
                btn.style.border = '1.5px solid rgb(96, 96, 96)';
            });
            this.style.border = '1.5px solid rgb(255, 122, 105)';
            
            // –û–±–Ω–æ–≤–ª—è–µ–º —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é "–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏"
            updateSwitchSpecification(switchId, data.available_switches);
        });
    });
    
    // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è —Å–ª–∞–π–¥–µ—Ä–∞
    setupSliderControls();
}

// –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏ –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–µ–π
function updateSwitchSpecification(switchId, switches) {
    const selectedSwitch = switches.find(sw => sw.id == switchId);
    if (!selectedSwitch) return;
    
    const switchSpec = `–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏`;
    const switchValue = `${selectedSwitch.name} (${selectedSwitch.type} ${selectedSwitch.actuation_force}–≥.)`;
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ
    const specs = document.querySelectorAll('#specificationsCode .key1');
    specs.forEach(spec => {
        if (spec.textContent.includes('–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏')) {
            const valueElement = spec.nextElementSibling.nextElementSibling;
            valueElement.textContent = `"${switchValue}"`;
        }
    });
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –≤ —Å–ø–∏—Å–∫–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫
    const specItems = document.querySelectorAll('#specificationsList .haracter');
    specItems.forEach(item => {
        const keyElement = item.querySelector('.spectext');
        if (keyElement.textContent === '–ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª–∏') {
            const valueElement = item.querySelector('.spectext2');
            valueElement.textContent = switchValue.toLowerCase();
        }
    });
}

// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–ª–∞–π–¥–µ—Ä–æ–º
function setupSliderControls() {
    let currentImageIndex = 0;
    const thumbnails = document.querySelectorAll('.thumbnail');
    
    document.querySelector('.next-btn').addEventListener('click', () => {
        currentImageIndex = (currentImageIndex + 1) % thumbnails.length;
        thumbnails[currentImageIndex].click();
    });
    
    document.querySelector('.prev-btn').addEventListener('click', () => {
        currentImageIndex = (currentImageIndex - 1 + thumbnails.length) % thumbnails.length;
        thumbnails[currentImageIndex].click();
    });
}

// –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ
document.addEventListener('DOMContentLoaded', () => {
    loadProductData();
    // –í–∞—à–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–∫—Ä–∏–ø—Ç—ã –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∏ –∫–æ—Ä–∑–∏–Ω—ã
    checkAuthAndDisplayUser();
    setupCartButton();
});

// –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∫–Ω–æ–ø–∫–∏ –∫–æ—Ä–∑–∏–Ω—ã (–∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø–æ–¥ –Ω–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ)
function setupCartButton() {
    document.getElementById('addToCartBtn')?.addEventListener('click', async () => {
        try {
            const response = await fetch('http://localhost:5000/check-auth', {
                headers: {
                    'Authorization': localStorage.getItem('authToken') || ''
                }
            });
        
            if (!response.ok) {
                alert('–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤–æ–π–¥–∏—Ç–µ –≤ –∞–∫–∫–∞—É–Ω—Ç, —á—Ç–æ–±—ã –¥–æ–±–∞–≤–ª—è—Ç—å —Ç–æ–≤–∞—Ä—ã –≤ –∫–æ—Ä–∑–∏–Ω—É.');
                window.location.href = '–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è.html';
                return;
            }
        
            const { user } = await response.json();
            const productName = document.getElementById('productName').textContent;
            const priceText = document.getElementById('productPrice').textContent;
            const price = parseFloat(priceText.replace(/[^\d.-]/g, ''));
            
            // –ü–æ–ª—É—á–∞–µ–º –≤—ã–±—Ä–∞–Ω–Ω—ã–π —Å–≤–∏—Ç—á
            const selectedSwitchButton = document.querySelector('.config-button[style*="rgb(255, 122, 105)"]');
            const selectedSwitch = selectedSwitchButton ? selectedSwitchButton.querySelector('.swbox').textContent.trim() : '';
            
            const cartKey = `cart_${user.name}`;
            let cart = JSON.parse(localStorage.getItem(cartKey)) || [];
            
            const existingItem = cart.find(item => 
                item.productName === productName && item.selectedSwitch === selectedSwitch
            );
            
            if (existingItem) {
                existingItem.quantity += 1;
            } else {
                cart.push({
                    productName: productName,
                    selectedSwitch: selectedSwitch,
                    price: price,
                    quantity: 1,
                    productId: getProductIdFromUrl()
                });
            }
            
            localStorage.setItem(cartKey, JSON.stringify(cart));
            alert('–¢–æ–≤–∞—Ä –¥–æ–±–∞–≤–ª–µ–Ω –≤ –∫–æ—Ä–∑–∏–Ω—É!');
        } catch (error) {
            console.error('–û—à–∏–±–∫–∞:', error);
            alert('–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –≤ –∫–æ—Ä–∑–∏–Ω—É');
        }
    });
}
</script>

<!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º –≤–∞—à–∏ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Å–∫—Ä–∏–ø—Ç—ã -->
<script src="script.js"></script>
<script src="check_authorization.js"></script>

</body>
</html>