<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>KeyDivide Сайт по продаже клавиатур</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="assets/css/stylesRegistr.css">
    <title>Авторизация</title>
</head>
<body>
    <div class="login-container">
        <h2>Регистрация</h2>
        <form class="form-box" id="registrationForm">
            <input type="text" id="login" name="login" placeholder="Введите логин" > 
            <input type="text" id="email" name="email" placeholder="Введите Email" >
            <input type="text" id="surname" name="surname" placeholder="Введите фамилию" >
            <input type="text" id="name" name="name" placeholder="Введите имя" >
            <div class="password_container">
                <input type="password" id="password" name="password" placeholder="Введите пароль" required>
                <span class="password-toggle" onclick="togglePassword()">&#128065;</span>
            </div>
            <input type="password" id="password2" name="password2" placeholder="Повторите пароль" required>
            <div id="message"></div>
            <div class="butt"> <button TYPE="submit"> Зарегистироваться </button></div> 
            <a href="Авторизация.html"><div class="forbutt"> Назад </div></a>        
        </form>
    </div>

    <!-- <script>
        const passwordInput = document.getElementById('password');
        const confirmPasswordInput = document.getElementById('password2');
        const messageDiv = document.getElementById('message');

        function 
        togglePassword() {
            const passImput = document.getElementById('password');
            const passTogg = document.querySelector('.password-toggle');
            if (passImput.type == 'password'){
                passImput.type = 'text';
                passTogg.innerHTML ='&#128066';
            }else{
                passImput.type = 'password'
                passTogg.innerHTML ='&#128065';
            }
        }

        confirmPasswordInput.addEventListener('input', function() {
          if (passwordInput.value === confirmPasswordInput.value) {
            messageDiv.textContent = 'Пароли совпадают';
            messageDiv.style.color = 'green';
          } else {
            messageDiv.textContent = 'Пароли не совпадают';
            messageDiv.style.color = 'red';
          }
        });

    </script> -->
    
    <script>
        document.getElementById('registrationForm').addEventListener('submit', async function(e) {
  e.preventDefault();
  
  const login = document.getElementById('login').value.trim();
  const email = document.getElementById('email').value.trim();
  const surname = document.getElementById('surname').value.trim();
  const name = document.getElementById('name').value.trim();
  const password = document.getElementById('password').value.trim();
  const password2 = document.getElementById('password2').value.trim();
  
  if (password !== password2) {
    document.getElementById('message').textContent = 'Пароли не совпадают';
    document.getElementById('message').style.color = 'red';
    return;
  }
  
    try {
        const response = await fetch('http://localhost:5000/register', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json',
          },
          body: JSON.stringify({
            login,
            email,
            surname,
            name,
            password
          }),
        });

        const data = await response.json();

        if (response.ok) {
          // Регистрация успешна
          localStorage.setItem('username', login);
          window.location.href = 'Главная.html';
        } 
        
        else {
          document.getElementById('message').textContent = data.error || 'Ошибка регистрации';
          document.getElementById('message').style.color = 'red';
        }
    } 
    catch (error) {
        console.error('Ошибка:', error);
        document.getElementById('message').textContent = 'Ошибка соединения с сервером';
        document.getElementById('message').style.color = 'red';
    }
    });
    </script>
</body>
</html>
